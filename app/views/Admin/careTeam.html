#{set pageType = 'careteam' /}
#{extends 'adminmain.html' /}
<div id="content" class="col-xs-12 col-sm-10">
		<div id="breadcrumb" class="col-xs-12">
		<ol class="breadcrumb">
			<li><a href="@{Admin.index()}">Home</a></li>
			<li><a href="#">Care Team</a></li>
		</ol>
	</div>
        <div class="col-xs-12 col-sm-12">
        		<button type="submit" class="btn btn-default addcareteam">Add Care Team</button>
        		<br/><br/>
				<div class="table-responsive">
				<table class="table table-striped table-bordered table-hover table-heading no-border-bottom">
					<thead>
		  			<tr>
		  				<th>Name</th>
		  			</tr>
		  			</thead>
		  			<tbody id="teamList">
		  			#{set cssClass = '' /}
		  			#{if list != null}
						#{list list, as:'seq'}
							#{set cssClass = '' /}
							<tr ${cssClass}>
					  			<td><a href="@{Admin.editCareTeam(seq.id)}" >${seq.name} CARE TEAM</a></td>
					  		</tr>
						#{/list}
					#{/if}
		  			#{else}
						<tr class="active">
							<td colspan="5">No Row</td>		
		  				</tr>
		  			#{/else}
		  			</tbody>
				</table>
				</div>
          </div>
</div>

<div class="modal fade" id="addCareTeam" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
   <div class="modal-dialog modal-lg">
   <div class="modal-content col-xs-12 col-sm-12">
   #{form @Admin.createCareTeam() , id:'teamForm' }
      	<input type="hidden" name="operation" />
      	<input type="hidden" name="id" />
   		<input type="hidden" name="patientId" value="${patientId}"/>
      		<div class="modal-header">
        		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        		<h4 class="modal-title" id="myModalLabel_note">NEW CARE TEAM</h4>
      		</div>
        	<div class="modal-body" style="display:block;">
                    <div class="form-group form-group-sm">
                        <label class="col-xs-3 control-label" for="rt_schedule">Type of Care Team</label>
                        <div class="col-xs-9 form-group input-group">
                            <input type="text"  name="teamtype" placeholder="i.e. Radiation Oncology" class="form-control typeField" required data-provide="typeahead" autocomplete="off">
                            <span class="input-group-addon has-error"><i class="fa fa-star"></i></span>
                        </div>
                    </div>
					<div class="form-group form-group-sm">
                        <label class="col-xs-3 control-label" for="rt_schedule">Center/Clinic Name</label>
                        <div class="col-xs-9 form-group input-group">
                            <input type="text"  name="center" placeholder="i.e. Moffitt Cancer Center TVRH" value="Moffitt Cancer Center TVRH" class="form-control" required>
                            <span class="input-group-addon has-error"><i class="fa fa-star"></i></span>
                        </div>
                    </div>
                    <div class="form-group form-group-sm">
                        <label class="col-xs-3 control-label" for="rt_schedule">Address</label>
                        <div class="col-xs-9 form-group input-group">
                            <input type="text"  name="address1" placeholder="i.e. 1400 U.S. Highway 441" value="1400 U.S. Highway 441" class="form-control" required>
                            <span class="input-group-addon has-error"><i class="fa fa-star"></i></span>
                        </div>
                    </div>
                    <!-- 
                    <div class="form-group form-group-sm">
                        <label class="col-xs-3 control-label" for="rt_schedule">Address 2</label>
                        <div class="col-xs-9 form-group input-group">
                            <input type="text"  name="address2" placeholder="i.e. Note for other care team members. Not for patients." class="form-control" required>
                            <span class="input-group-addon has-error"><i class="fa fa-star"></i></span>
                        </div>
                    </div>
                     -->
                    <div class="form-group form-group-sm">
                        <label class="col-xs-3 control-label" for="rt_schedule">City</label>
                        <div class="col-xs-9 form-group input-group">
                            <input type="text"  name="city" placeholder="i.e. The Villages" value="The Villages" class="form-control" required>
                            <span class="input-group-addon has-error"><i class="fa fa-star"></i></span>
                        </div>
                    </div>
                    <div class="form-group form-group-sm">
                        <label class="col-xs-3 control-label" for="rt_schedule">State</label>
                        <div class="col-xs-9 form-group input-group">
                            <input type="text"  name="state" placeholder="i.e. FL" value="FL" class="form-control" required>
                            <span class="input-group-addon has-error"><i class="fa fa-star"></i></span>
                        </div>
                    </div>
                    <div class="form-group form-group-sm">
                        <label class="col-xs-3 control-label" for="rt_schedule">Zip</label>
                        <div class="col-xs-9 form-group input-group">
                            <input type="text"  name="zip" placeholder="i.e. 32159" value="32159" class="form-control" required>
                            <span class="input-group-addon has-error"><i class="fa fa-star"></i></span>
                        </div>
                    </div>
    		</div>
     		<div class="modal-footer col-xs-12 col-sm-12" >
       			<button type="submit" class="btn btn-default" data-next="3"> SUBMIT </button>
    		</div>
      #{/form}
		</div>
	</div>
</div>
	<div id="ajax-panel"></div>

<script type="text/javascript">
<!-- -->
var typeArray = ["Radiation Oncology","Oncology","Surgery","Radiology","Urology","Gastroenterology","OBGYN","Primary Care","Cardiology","Hematology"];

$(document).ready(function() {
	
	$('body').on('click', 'button.addcareteam', function() {
		$("#appointmentForm input[name='teamtype']").val("");
		$('#addCareTeam').appendTo("body").modal();
	});
	
	$("input.typeField").typeahead({ source: typeArray,minLength: 0 });
	
	$('#teamForm').submit(function(event) {
		var postData = $("#teamForm").serializeArray();
		var formURL = $("#teamForm").attr("action");
		$.post(formURL, postData, function( data ) {
			$("#teamList").append(data);
			$('#ajax-panel').empty();
			$('#ajax-panel').append('<strong>Care Team</strong>:New CareTeam Created.');
			$('#addCareTeam').modal('hide');
		}).always(function() {
			setTimeout(function(){removeAjaxPanel();}, 2000);
		});
 		event.preventDefault();
	});
	
	
	$(".userVerifiedCheckbox").click(function(){
		var userId = $(this).data('for');
		var isVerified = 'false';
		if ($(this).prop('checked')==true) {
			isVerified = 'true';
		}
		$.ajax({
			  type: 'POST',
			  url: '/admin/adminAjaxOperation',
			  data: { 'userId': userId,'op':'v' , 'flag': isVerified },
			  beforeSend:function(){
			    $('#ajax-panel').show();
			    $('#ajax-panel').html('Loading... <i class="fa fa-spinner fa-spin"></i>');
			  },
			  success:function(data){
			    $('#ajax-panel').empty();
			      $('#ajax-panel').append('<strong>' + data.status + '</strong>:' + data.messages + '');
			  },
			  error:function(){
			    $('#ajax-panel').html('<strong>Oops!</strong> Try that again in a few moments.');
			   
			  }
		}).always(function() {
			setTimeout(function(){removeAjaxPanel();}, 2000);
		});
	});
	
	$(".userActivateCheckbox").click(function(){
		var userId = $(this).data('for');
		var isVerified = 'false';
		if ($(this).prop('checked')==true) {
			isVerified = 'true';
		}
		$.ajax({
			  type: 'POST',
			  url: '/admin/adminAjaxOperation',
			  data: { 'userId': userId,'op':'a' , 'flag': isVerified },
			  beforeSend:function(){
			    $('#ajax-panel').show();
			    $('#ajax-panel').html('Loading... <i class="fa fa-spinner fa-spin"></i>');
			  },
			  success:function(data){
			    $('#ajax-panel').empty();
			      $('#ajax-panel').append('<strong>' + data.status + '</strong>:' + data.messages + '');
			  },
			  error:function(){
			    $('#ajax-panel').html('<strong>Oops!</strong> Try that again in a few moments.');
			   
			  }
		}).always(function() {
			setTimeout(function(){removeAjaxPanel();}, 2000);
		});
	});
});
removeAjaxPanel = function() {
	$('#ajax-panel').fadeOut("fast", function() {
		$('#ajax-panel').empty();
	});
}
</script>
